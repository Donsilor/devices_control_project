<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>HdSmart API List</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="lbox_close wxapi_form">
        <br>
        <ul>
            <li><strong>token: </strong><span id="token"></span></li>
            <li><strong>device_uuid: </strong><span id="device_uuid"></span></li>
            <li><strong>device_name: </strong><span id="device_name"></span></li>
            <li><strong>device_category_id: </strong><span id="device_category_id"></span></li>
        </ul>
        <h3>Device</h3>
        <span class="desc">设备监听（onDeviceListen）</span><br>
        <textarea id="raw" disabled style="width:100%;height: 150px;"></textarea>
        <span class="desc">获取设备快照</span>
        <button class="btn btn_primary" id="getSnapShot">getSnapShot</button>
        <span class="desc">发送指令控制设备</span><br>
        <input type="radio" id="newplat" name="pf"><label for="newplat">新平台（空调）</label>
        <input type="radio" id="oldplat" name="pf"><label for="oldplat">老平台（窗帘）</label>
        <textarea id="code" style="width:100%;height: 150px;"></textarea>
        <button class="btn btn_primary" id="control">control</button>
        <span class="desc">postRequest</span>
        <button class="btn btn_primary" id="postRequest">postRequest</button>

        <h3>UI</h3>
        <span class="desc">消息提示框</span>
        <button class="btn btn_primary" id="alert">alert</button>
        <span class="desc">显示系统loading</span>
        <button class="btn btn_primary" id="showLoading">showLoading</button>
        <span class="desc">隐藏系统loading</span>
        <button class="btn btn_primary" id="hideLoading">hideLoading</button>
        <span class="desc">setWebViewTouchRect</span>
        <button class="btn btn_primary" id="setWebViewTouchRect">setWebViewTouchRect</button>
        <span class="desc">toast</span>
        <button class="btn btn_primary" id="toast">toast</button>
        <span class="desc">toggleHeadAndFoot</span>
        <button class="btn btn_primary" id="toggleHeadAndFoot">toggleHeadAndFoot</button>


        <h3>Util</h3>
        <span class="desc">dispatchEvent</span>
        <button class="btn btn_primary" id="dispatchEvent">dispatchEvent</button>
        <span class="desc">getNetworkType</span>
        <button class="btn btn_primary" id="getNetworkType">getNetworkType</button>
        <span class="desc">post</span>
        <button class="btn btn_primary" id="post">post</button>
        <span class="desc">reload</span>
        <button class="btn btn_primary" id="reload">reload</button>
        <span class="desc">sendNotification</span>
        <button class="btn btn_primary" id="sendNotification">sendNotification</button>

    </div>

<script src="dist/hdsmart.js"></script>
<script>

    var $ = function(selector){
        return document.querySelector(selector)
    }

    HdSmart.ready(function(){

        $('#token').innerHTML = HdSmart.helper.getToken()
        $('#device_uuid').innerHTML = HdSmart.helper.getDeviceUUID()
        $('#device_name').innerHTML = HdSmart.helper.getDeviceName()
        $('#device_category_id').innerHTML = HdSmart.helper.getDeviceCategory()

        HdSmart.onDeviceListen(function(data){
            $('#raw').value = JSON.stringify(data, null, 2)
        })
        //Device
        $('#getSnapShot').onclick = function(){
            HdSmart.Device.getSnapShot(function(data){
                alert(JSON.stringify(data))
            })
        }
        $('#oldplat').onclick = function(){
            $('#code').value = JSON.stringify({
                method: 'dm_set_zigbee_curtain',
                params: {
                    cmd: 'setOnoff',
                    attribute: {
                        mode: 'on'
                    }
                }
            }, null, 2)
        }
        $('#newplat').onclick = function(){
            $('#code').value = JSON.stringify({
                method: 'dm_set',
                nodeid: 'airconditioner.main.temperature',
                params: {
                    timer: null,
                    attribute: {
                        temperature: 25
                    }
                }
            }, null, 2)
        }
        $('#control').onclick = function(){
            HdSmart.Device.control(JSON.parse($('#code').value), function(data){
                alert(JSON.stringify(data))
            },function(){
                alert('控制失败')
            })
        }
        //UI
        $('#alert').onclick = function(){
            HdSmart.UI.alert('标题', '内容', function(){
                alert('你点击了确定')
            }, '是', '否')
        }
        $('#showLoading').onclick = function(){
            HdSmart.UI.showLoading()
        }
        $('#hideLoading').onclick = function(){
            HdSmart.UI.hideLoading()
        }
        $('#toast').onclick = function(){
            HdSmart.UI.toast('测试toast')
        }
        $('#toggleHeadAndFoot').onclick = function(){
            this.clicked = !this.clicked
            HdSmart.UI.toggleHeadAndFoot(this.clicked)
        }
        //Util
    })
</script>
</body>
</html>
